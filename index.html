<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malla Interactiva Bioanálisis - UCV</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            background-color: white;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 15px;
            border-bottom: 3px solid #0E0E55;
        }
        
        h1 {
            color: #0E0E55;
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            color: #555;
            font-size: 1.1rem;
        }
        
        .malla-container {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 15px 5px;
            margin: 20px 0;
            scrollbar-width: thin;
            scrollbar-color: #000080 #f0f0f0;
        }
        
        .malla-container::-webkit-scrollbar {
            height: 10px;
        }
        
        .malla-container::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 5px;
        }
        
        .malla-container::-webkit-scrollbar-thumb {
            background: #000080;
            border-radius: 5px;
        }
        
        .semestre {
            min-width: 250px;
            border: 3px solid #0E0E55;
            border-radius: 12px;
            background: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        
        .semestre-header {
            background: #000080;
            color: white;
            text-align: center;
            padding: 12px;
            font-weight: bold;
            font-size: 20px;
            border-radius: 8px 8px 0 0;
        }
        
        .materias-container {
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            min-height: 400px;
        }
        
        .materia {
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            border: 1px solid #ddd;
        }
        
        .materia.available {
            background: #FFEE8C;
            color: black;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .materia.completed {
            background: #E05F77;
            color: white;
            text-decoration: line-through;
        }
        
        .materia.locked {
            background: #f0f0f0;
            color: #888;
            cursor: not-allowed;
        }
        
        .materia.available:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        
        .materia h4 {
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .creditos {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.1);
            border-radius: 12px;
            padding: 3px 8px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .codigo {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 40px 0 20px;
            flex-wrap: wrap;
        }
        
        .stat-card {
            background: #f0f8ff;
            border: 2px solid #0E0E55;
            border-radius: 10px;
            padding: 15px;
            min-width: 180px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #000080;
        }
        
        .progress-container {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #000080, #0E0E55);
            border-radius: 5px;
            transition: width 0.5s;
        }
        
        .notion-tip {
            background: #e0f7fa;
            border-left: 4px solid #00838f;
            padding: 15px;
            margin: 30px 0;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .semestre {
                min-width: 220px;
            }
            
            .stats {
                gap: 15px;
            }
            
            .stat-card {
                min-width: 150px;
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>LICENCIATURA EN BIOANÁLISIS - UCV</h1>
        <p class="subtitle">Malla curricular interactiva</p>
    </header>
    
    <div class="malla-container" id="malla-container">
        <!-- Semestres se generarán con JavaScript -->
    </div>
    
    <div class="stats">
        <div class="stat-card">
            <div>Créditos completados</div>
            <div class="stat-value" id="creditos-completados">0</div>
            <div>de 169 totales</div>
        </div>
        <div class="stat-card">
            <div>Materias completadas</div>
            <div class="stat-value" id="materias-completadas">0</div>
            <div>de 47 totales</div>
        </div>
        <div class="stat-card">
            <div>Progreso general</div>
            <div class="progress-container">
                <div class="progress-bar" id="progreso-general" style="width: 0%"></div>
            </div>
            <div class="stat-value" id="porcentaje-progreso">0%</div>
        </div>
    </div>
    
    <div class="notion-tip">
        <strong>Para usar en Notion:</strong> 
        <p>1. Copia esta URL y pégalo en un bloque Embed de Notion</p>
        <p>2. Haz clic en las materias disponibles para marcarlas como completadas</p>
        <p>3. Tu progreso se guardará automáticamente en tu navegador</p>
    </div>

    <script>
        // Datos completos del pensum
        const pensum = [
            // Semestre 1
            {
                semestre: 1,
                materias: [
                    { id: "bioestadistica1", nombre: "Bioestadística I", codigo: "0902003458", creditos: 4, requisitos: [] },
                    { id: "matematica1", nombre: "Matemática I", codigo: "0902003455", creditos: 3, requisitos: [] },
                    { id: "histologia", nombre: "Histología", codigo: "0902003456", creditos: 5, requisitos: [] },
                    { id: "metodologia", nombre: "Metodología Inv.", codigo: "0902003459", creditos: 1, requisitos: [] },
                    { id: "principios_quimica", nombre: "Principios de Química", codigo: "0902003457", creditos: 3, requisitos: [] }
                ]
            },
            // Semestre 2
            {
                semestre: 2,
                materias: [
                    { id: "anatomia1", nombre: "Anatomía y Embriología I", codigo: "0902002520", creditos: 4, requisitos: ["histologia"] },
                    { id: "matematica2", nombre: "Matemática II", codigo: "0902003460", creditos: 4, requisitos: ["matematica1"] },
                    { id: "fisica1", nombre: "Física I", codigo: "0902003274", creditos: 4, requisitos: ["matematica1"] },
                    { id: "quimica_organica1", nombre: "Química Orgánica I", codigo: "0902003461", creditos: 4, requisitos: ["principios_quimica"] }
                ]
            },
            // Semestre 3
            {
                semestre: 3,
                materias: [
                    { id: "epidemiologia", nombre: "Epidemiología", codigo: "0902003288", creditos: 3, requisitos: ["bioestadistica1"] },
                    { id: "anatomia2", nombre: "Anatomía II", codigo: "0902002526", creditos: 2, requisitos: ["anatomia1"] },
                    { id: "fisica2", nombre: "Física II", codigo: "0902003275", creditos: 4, requisitos: ["fisica1", "matematica1"] },
                    { id: "quimica_analitica", nombre: "Química Analítica", codigo: "0902002523", creditos: 5, requisitos: ["principios_quimica"] }
                ]
            },
            // Semestre 4
            {
                semestre: 4,
                materias: [
                    { id: "bioquimica1", nombre: "Bioquímica I", codigo: "0902002991", creditos: 6, requisitos: ["quimica_organica1", "quimica_analitica", "bioestadistica1"] },
                    { id: "fisiologia", nombre: "Fisiología", codigo: "0902002994", creditos: 5, requisitos: ["histologia", "fisica2"] },
                    { id: "sociologia", nombre: "Sociología", codigo: "0902003462", creditos: 3, requisitos: ["anatomia1"] }
                ]
            },
            // Semestre 5
            {
                semestre: 5,
                materias: [
                    { id: "bioquimica2", nombre: "Bioquímica II", codigo: "0902002992", creditos: 2, requisitos: ["bioquimica1"] },
                    { id: "bacteriologia1", nombre: "Bacteriología I", codigo: "0902003465", creditos: 3, requisitos: ["bioquimica1"] },
                    { id: "inmunologia1", nombre: "Immunología I", codigo: "0902002999", creditos: 2, requisitos: ["bioquimica1"] },
                    { id: "deontologia", nombre: "Deontología", codigo: "0902003464", creditos: 3, requisitos: ["45creditos"] },
                    { id: "administracion", nombre: "Administración Sanitaria", codigo: "0902003463", creditos: 3, requisitos: ["40creditos"] }
                ]
            },
            // Semestre 6
            {
                semestre: 6,
                materias: [
                    { id: "bioquimica_clinica1", nombre: "Bioquímica Cl. I", codigo: "0902003277", creditos: 5, requisitos: ["fisiologia", "bioquimica2"] },
                    { id: "bacteriologia2", nombre: "Bacteriología II", codigo: "0902003466", creditos: 4, requisitos: ["bacteriologia1", "inmunologia1"] },
                    { id: "lab_inmunologia", nombre: "Laboratorio de Inmunología", codigo: "0902003278", creditos: 2, requisitos: ["inmunologia1", "bacteriologia1"] },
                    { id: "micologia1", nombre: "Micología I", codigo: "0902003279", creditos: 3, requisitos: ["bacteriologia1", "inmunologia1", "epidemiologia"] }
                ]
            },
            // Semestre 7
            {
                semestre: 7,
                materias: [
                    { id: "bacteriologia3", nombre: "Bacteriología III", codigo: "0902003467", creditos: 4, requisitos: ["bacteriologia2"] },
                    { id: "hematologia1", nombre: "Hematología I", codigo: "0902003280", creditos: 5, requisitos: ["fisiologia", "bioquimica2", "lab_inmunologia"] },
                    { id: "parasitologia1", nombre: "Parasitología I", codigo: "0902002988", creditos: 4, requisitos: ["lab_inmunologia"] },
                    { id: "virologia", nombre: "Virología", codigo: "0902003284", creditos: 3, requisitos: ["lab_inmunologia", "fisiologia"] }
                ]
            },
            // Semestre 8
            {
                semestre: 8,
                materias: [
                    { id: "bioquimica_clinica2", nombre: "Bioquímica Cl. II", codigo: "0902003281", creditos: 5, requisitos: ["bioquimica_clinica1", "hematologia1"] },
                    { id: "hematologia2", nombre: "Hematología II", codigo: "0902003282", creditos: 5, requisitos: ["hematologia1"] },
                    { id: "parasitologia2", nombre: "Parasitología II", codigo: "0902003283", creditos: 3, requisitos: ["lab_inmunologia"] },
                    { id: "toxicologia", nombre: "Toxicología", codigo: "0902003285", creditos: 5, requisitos: ["hematologia1", "bioquimica_clinica1"] }
                ]
            },
            // Semestre 9-10
            {
                semestre: "9-10",
                materias: [
                    { id: "internado", nombre: "Internado R + TEI", codigo: "0902003508", creditos: 30, requisitos: ["pre-internado"] },
                    { id: "electivas", nombre: "Asignaturas electivas", codigo: "", creditos: 18, requisitos: [] }
                ]
            }
        ];

        // Estado de las materias
        let estadoMaterias = {};
        
        // Inicializar
        function init() {
            // Cargar estado guardado si existe
            const guardado = localStorage.getItem('estadoMaterias');
            if (guardado) {
                estadoMaterias = JSON.parse(guardado);
            } else {
                // Inicializar todas como no completadas
                pensum.forEach(semestre => {
                    semestre.materias.forEach(materia => {
                        estadoMaterias[materia.id] = false;
                    });
                });
            }
            
            renderMalla();
            actualizarEstadisticas();
        }
        
        // Renderizar la malla
        function renderMalla() {
            const container = document.getElementById('malla-container');
            container.innerHTML = '';
            
            pensum.forEach(semestre => {
                const semestreDiv = document.createElement('div');
                semestreDiv.className = 'semestre';
                
                const header = document.createElement('div');
                header.className = 'semestre-header';
                header.textContent = `Semestre ${semestre.semestre}`;
                semestreDiv.appendChild(header);
                
                const materiasContainer = document.createElement('div');
                materiasContainer.className = 'materias-container';
                
                semestre.materias.forEach(materia => {
                    const materiaDiv = document.createElement('div');
                    materiaDiv.className = 'materia';
                    
                    // Determinar el estado de la materia
                    if (estadoMaterias[materia.id]) {
                        materiaDiv.classList.add('completed');
                    } else if (estaDisponible(materia)) {
                        materiaDiv.classList.add('available');
                    } else {
                        materiaDiv.classList.add('locked');
                    }
                    
                    // Contenido de la materia
                    materiaDiv.innerHTML = `
                        <h4>${materia.nombre}</h4>
                        <div class="codigo">${materia.codigo}</div>
                        <div class="creditos">${materia.creditos} CR</div>
                    `;
                    
                    // Evento click solo para materias disponibles
                    if (estaDisponible(materia)) {
                        materiaDiv.addEventListener('click', () => {
                            estadoMaterias[materia.id] = true;
                            localStorage.setItem('estadoMaterias', JSON.stringify(estadoMaterias));
                            renderMalla();
                            actualizarEstadisticas();
                        });
                    }
                    
                    materiasContainer.appendChild(materiaDiv);
                });
                
                semestreDiv.appendChild(materiasContainer);
                container.appendChild(semestreDiv);
            });
        }
        
        // Verificar si una materia está disponible
        function estaDisponible(materia) {
            if (estadoMaterias[materia.id]) return false; // Ya completada
            
            // Verificar requisitos especiales
            if (materia.requisitos.includes('45creditos')) {
                if (calcularCreditosCompletados() < 45) return false;
            }
            
            if (materia.requisitos.includes('40creditos')) {
                if (calcularCreditosCompletados() < 40) return false;
            }
            
            if (materia.requisitos.includes('pre-internado')) {
                // Verificar que todas las materias de semestres 1-8 estén completadas
                const materiasPre = pensum.filter(s => s.semestre !== "9-10").flatMap(s => s.materias);
                for (const m of materiasPre) {
                    if (!estadoMaterias[m.id]) return false;
                }
            }
            
            // Verificar requisitos normales
            for (const reqId of materia.requisitos) {
                if (reqId !== '45creditos' && reqId !== '40creditos' && reqId !== 'pre-internado') {
                    if (!estadoMaterias[reqId]) {
                        return false;
                    }
                }
            }
            
            return true;
        }
        
        // Calcular créditos completados
        function calcularCreditosCompletados() {
            let total = 0;
            pensum.forEach(semestre => {
                semestre.materias.forEach(materia => {
                    if (estadoMaterias[materia.id]) {
                        total += materia.creditos;
                    }
                });
            });
            return total;
        }
        
        // Calcular materias completadas
        function calcularMateriasCompletadas() {
            return Object.values(estadoMaterias).filter(v => v).length;
        }
        
        // Verificar pre-internado
        function verificarPreInternado() {
            const materiasPre = pensum.filter(s => s.semestre !== "9-10").flatMap(s => s.materias);
            return materiasPre.every(m => estadoMaterias[m.id]);
        }
        
        // Actualizar estadísticas
        function actualizarEstadisticas() {
            const creditos = calcularCreditosCompletados();
            const materias = calcularMateriasCompletadas();
            const porcentaje = Math.round((creditos / 169) * 100);
            
            document.getElementById('creditos-completados').textContent = creditos;
            document.getElementById('materias-completadas').textContent = materias;
            document.getElementById('porcentaje-progreso').textContent = `${porcentaje}%`;
            document.getElementById('progreso-general').style.width = `${porcentaje}%`;
        }
        
        // Inicializar cuando el documento esté cargado
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
